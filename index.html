<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Instagram Unfollower Manager</title>
    <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@300;400;700&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Roboto', sans-serif;
            background-color: #f3f4f6;
            margin: 0;
            padding: 0;
            color: #333;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: flex-start;
            min-height: 100vh;
        }

        h1 {
            color: #333;
            font-weight: 700;
            margin: 20px 0;
            font-size: 2.5em;
        }

        .container {
            width: 90%;
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
            display: flex;
            flex-direction: column;
        }

        /* File Input and Copy Button Section */
        .controls {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
        }

        #jsonFile {
            padding: 10px 20px;
            font-size: 1em;
            border: 1px solid #ccc;
            border-radius: 8px;
            cursor: pointer;
            background-color: #6789BA;
            color: #fff;
        }

        #copyButton {
            padding: 10px 20px;
            background-color: #28a745;
            color: white;
            border-radius: 8px;
            cursor: pointer;
            border: none;
            font-size: 1em;
            visibility: hidden; /* Initially hidden */
        }

        #copyButton:hover {
            background-color: #218838;
        }

        /* Stats Section */
        .stats {
            display: flex;
            justify-content: space-around;
            margin-bottom: 20px;
            text-align: center;
        }

        .stats div {
            background-color: #f8f9fa;
            padding: 15px 20px;
            border-radius: 8px;
            box-shadow: 0 2px 5px rgba(0, 0, 0, 0.1);
            width: 18%;
            padding: 10px;
           align-content: center;
        }

        .stats div span {
            font-weight: bold;
            display: block;
            margin-bottom: 5px;
            font-size: 1.2em;
            color: #333;
        }

        .stats div small {
            color: #555;
            font-size: 0.85em;
        }

        /* Filters Section */
        .filters {
            display: flex;
            flex-wrap: wrap;
            gap: 10px;
            justify-content: center;
            margin-bottom: 20px;
        }

        .filters label {
            background-color: #7EC0E4;
            color: white;
            padding: 10px 15px;
            border-radius: 50px;
            cursor: pointer;
            transition: background-color 0.3s ease;
            font-size: 0.9em;
        }

        .filters input[type="checkbox"] {
            margin-right: 10px;
        }

        .filters label:hover {
            background-color: #7EC0E4;
        }

        #addByFilterButton {
            padding: 10px 20px;
            background-color: #ffc107;
            color: white;
            border-radius: 8px;
            cursor: pointer;
            border: none;
            font-size: 1em;
        }

        #addByFilterButton:hover {
            background-color: #e0a800;
        }

        #removeAllButton {
            padding: 10px 20px;
            background-color: #F02A71;
            color: white;
            border-radius: 8px;
            cursor: pointer;
            border: none;
            margin-top: 10px;
            width: 100%;
        }

        #removeAllButton:hover {
            background-color: #c82333;
        }

        /* User Lists */
        .user-lists {
            padding: 15px;
            display: flex;
            gap: 20px;
            width: 100%;
        }

        .user-list, .selected-list {
            flex: 1;
            background-color: white;
            padding: 20px;
            border-radius: 10px;
            box-shadow: 0px 2px 5px rgba(0, 0, 0, 0.1);
            max-height: 500px;
            overflow-y: auto;
        }

        .user-list h2, .selected-list h2 {
            text-align: center;
            font-size: 1.5em;
            margin-bottom: 20px;
        }

        /* User Cards */
        .user-card {
            display: flex;
            align-items: center;
            justify-content: space-between;
            padding: 10px;
            margin-bottom: 10px;
            border-bottom: 1px solid #f1f1f1;
        }

        .user-card img {
            border-radius: 50%;
            width: 50px;
            height: 50px;
            object-fit: cover;
            margin-right: 10px;
        }

        .user-card img.broken {
            content: url('https://via.placeholder.com/50'); /* Default mockup image */
        }

        .user-card p {
            font-size: 1em;
            margin: 0;
        }

        .user-card input[type="checkbox"] {
            margin-right: 10px;
        }

        .user-card button {
            background-color: #F02A71;
            color: white;
            border: none;
            padding: 5px 10px;
            border-radius: 8px;
            cursor: pointer;
        }

        .user-card button:hover {
            background-color: #F02A71;
        }

        /* Footer Section */
        footer {
            margin-top: 20px;
            padding: 15px;
            width: 100%;
            background-color: #333;
            color: white;
            text-align: center;
            font-size: 0.9em;
        }

        footer a {
            color: #7EC0E4;
            text-decoration: none;
        }

        footer a:hover {
            text-decoration: underline;
        }

        /* Responsive Adjustments */
        @media (max-width: 768px) {
            .controls, .stats {
                flex-direction: column;
            }

            .stats div {
                width: 100%;
                margin-bottom: 10px;
            }

            .user-lists {
                flex-direction: column;
            }
        }
    </style>
</head>
<body>

    <h1>Instagram Unfollower Manager</h1>

    <!-- Main Container -->
    <div class="container">

        <!-- File Input and Copy Button Section -->
        <div class="controls">
            <input type="file" id="jsonFile" accept=".json">
            <button id="copyButton">Copy Selected to Clipboard</button>
        </div>

        <!-- Stats Section -->
        <div class="stats">
            <div>
                <span id="totalUsers">0</span>
                Total Users
            </div>
            <div>
                <span id="privateCount">0</span>Private
                <span id="publicCount">0</span>Public
            </div>
            <div>
                <span id="verifiedCount">0</span>Verified
                <span id="unverifiedCount">0</span>Unverified
            </div>
            <div>
                <span id="followedCount">0</span>Followed by Viewer
                <span id="notFollowedCount">0</span>Not Followed
            </div>
            <div style="background-color: #F02A71;">
                <span id="selectedCount">0</span>
                Selected for Removal
            </div>
        </div>

        <!-- Filters and Add by Filter Button -->
        <div class="filters">
            <label>
                <input type="checkbox" id="filterPrivate"> Private Accounts
            </label>
            <label>
                <input type="checkbox" id="filterPublic"> Public Accounts
            </label>
            <label>
                <input type="checkbox" id="filterVerified"> Verified Accounts
            </label>
            <label>
                <input type="checkbox" id="filterUnverified"> Unverified Accounts
            </label>
            <label>
                <input type="checkbox" id="filterFollowedByViewer"> Followed By Viewer
            </label>
            <label>
                <input type="checkbox" id="filterNotFollowedByViewer"> Not Followed by Viewer
            </label>
            <label>
                <input type="checkbox" id="filterFollowsViewer"> Follows Viewer
            </label>
            <label>
                <input type="checkbox" id="filterNotFollowsViewer"> Does Not Follow Viewer
            </label>
            <label>
                <input type="checkbox" id="filterRequestedByViewer"> Requested By Viewer
            </label>
            <label>
                <input type="checkbox" id="filterNotRequestedByViewer"> Not Requested by Viewer
            </label>
        </div>

        <!-- Add All by Filter Button -->
        <button id="addByFilterButton">Add All by Filter</button>

        <!-- User Lists (Left: All Profiles | Right: Selected Profiles) -->
        <div class="user-lists">
            <!-- All Profiles -->
            <div class="user-list">
                <h2>All Profiles</h2>
                <div id="userList"></div>
            </div>

            <!-- Selected Profiles -->
            <div class="selected-list">
                <h2>Selected Profiles</h2>
                <button id="removeAllButton">Remove All from Selected</button>
                <div id="selectedList"></div>
            </div>
        </div>
    </div>

    <!-- Footer Section -->
    <footer>
        Developed by <a href="https://github.com/herhu" target="_blank">https://github.com/herhu</a> with love ðŸ’™ | 
        Learn how to use this tool: <a href="https://github.com/herhu/RemoveInstagramUnfollowers" target="_blank">GitHub Repo</a>
    </footer>

    <script>
        let usersData = [];
        let filteredUsers = [];
        let selectedUsers = [];

        // Function to load the JSON file
        document.getElementById('jsonFile').addEventListener('change', function(event) {
            const file = event.target.files[0];
            const reader = new FileReader();

            reader.onload = function(e) {
                usersData = JSON.parse(e.target.result);
                filteredUsers = [...usersData]; // Start with all users
                displayUsers(usersData);
                updateStats(usersData);
            };

            if (file) {
                reader.readAsText(file);
            }
        });

        // Function to display the users in the list
        function displayUsers(users) {
            const userList = document.getElementById('userList');
            userList.innerHTML = '';  // Clear previous data

            users.forEach(user => {
                const userCard = document.createElement('div');
                userCard.classList.add('user-card');

                const img = document.createElement('img');
                img.src = user.profile_pic_url;
                img.alt = user.username;

                // Handle broken image
                img.onerror = function() {
                    img.classList.add('broken'); // Use fallback mockup
                };

                const checkbox = document.createElement('input');
                checkbox.type = 'checkbox';
                checkbox.value = user.username;
                checkbox.addEventListener('change', () => handleSelection(user, checkbox.checked));

                userCard.appendChild(img);
                userCard.innerHTML += `<p>${user.username}</p>`;
                userCard.appendChild(checkbox);
                userList.appendChild(userCard);
            });
        }

        // Function to handle user selection
        function handleSelection(user, isChecked) {
            if (isChecked) {
                // Add to selected list
                selectedUsers.push(user);
            } else {
                // Remove from selected list
                selectedUsers = selectedUsers.filter(u => u.id !== user.id);
            }

            displaySelectedUsers(); // Refresh the right-side list
            updateSelectedCount(); // Update selected count
            enableCopyButton(); // Enable or disable copy button based on selection
        }

        // Display selected users in the right-hand side list
        function displaySelectedUsers() {
            const selectedList = document.getElementById('selectedList');
            selectedList.innerHTML = '';  // Clear previous list

            selectedUsers.forEach(user => {
                const userCard = document.createElement('div');
                userCard.classList.add('user-card');

                const img = document.createElement('img');
                img.src = user.profile_pic_url;
                img.alt = user.username;

                // Handle broken image
                img.onerror = function() {
                    img.classList.add('broken'); // Use fallback mockup
                };

                const removeButton = document.createElement('button');
                removeButton.innerText = 'Remove';
                removeButton.addEventListener('click', () => removeFromSelected(user));

                userCard.appendChild(img);
                userCard.innerHTML += `<p>${user.username}</p>`;
                userCard.appendChild(removeButton);
                selectedList.appendChild(userCard);
            });
        }

        // Remove a user from the selected list
        function removeFromSelected(user) {
            selectedUsers = selectedUsers.filter(u => u.id !== user.id);
            displaySelectedUsers(); // Refresh the right-side list
            updateSelectedCount(); // Update selected count
            enableCopyButton(); // Enable or disable copy button based on selection
        }

        // Apply filters and display filtered users
        function applyFilters() {
            const filters = {
                filterPrivate: document.getElementById('filterPrivate').checked,
                filterPublic: document.getElementById('filterPublic').checked,
                filterVerified: document.getElementById('filterVerified').checked,
                filterUnverified: document.getElementById('filterUnverified').checked,
                filterFollowedByViewer: document.getElementById('filterFollowedByViewer').checked,
                filterNotFollowedByViewer: document.getElementById('filterNotFollowedByViewer').checked,
                filterFollowsViewer: document.getElementById('filterFollowsViewer').checked,
                filterNotFollowsViewer: document.getElementById('filterNotFollowsViewer').checked,
                filterRequestedByViewer: document.getElementById('filterRequestedByViewer').checked,
                filterNotRequestedByViewer: document.getElementById('filterNotRequestedByViewer').checked
            };

            filteredUsers = usersData.filter(user => {
                return (!filters.filterPrivate || user.is_private) &&
                    (!filters.filterPublic || !user.is_private) &&
                    (!filters.filterVerified || user.is_verified) &&
                    (!filters.filterUnverified || !user.is_verified) &&
                    (!filters.filterFollowedByViewer || user.followed_by_viewer) &&
                    (!filters.filterNotFollowedByViewer || !user.followed_by_viewer) &&
                    (!filters.filterFollowsViewer || user.follows_viewer) &&
                    (!filters.filterNotFollowsViewer || !user.follows_viewer) &&
                    (!filters.filterRequestedByViewer || user.requested_by_viewer) &&
                    (!filters.filterNotRequestedByViewer || !user.requested_by_viewer);
            });

            displayUsers(filteredUsers);
        }

        // Add all filtered users to the selected list
        document.getElementById('addByFilterButton').addEventListener('click', function() {
            filteredUsers.forEach(user => {
                if (!selectedUsers.some(u => u.id === user.id)) {
                    selectedUsers.push(user); // Add unique users
                }
            });

            displaySelectedUsers(); // Refresh right-hand list
            updateSelectedCount();
            enableCopyButton(); // Enable copy button
        });

        // Remove all users from the selected list
        document.getElementById('removeAllButton').addEventListener('click', function() {
            selectedUsers = []; // Clear the selected users list
            displaySelectedUsers(); // Refresh the right-side list
            updateSelectedCount();
            enableCopyButton(); // Hide copy button
        });

        // Update Stats
        function updateStats(users) {
            const privateCount = users.filter(user => user.is_private).length;
            const verifiedCount = users.filter(user => user.is_verified).length;
            const followedCount = users.filter(user => user.followed_by_viewer).length;

            document.getElementById('totalUsers').innerText = users.length;
            document.getElementById('privateCount').innerText = privateCount;
            document.getElementById('publicCount').innerText = users.length - privateCount;
            document.getElementById('verifiedCount').innerText = verifiedCount;
            document.getElementById('unverifiedCount').innerText = users.length - verifiedCount;
            document.getElementById('followedCount').innerText = followedCount;
            document.getElementById('notFollowedCount').innerText = users.length - followedCount;
        }

        // Update selected count
        function updateSelectedCount() {
            document.getElementById('selectedCount').innerText = selectedUsers.length;
        }

        // Enable or disable the "Copy to Clipboard" button
        function enableCopyButton() {
            const copyButton = document.getElementById('copyButton');
            copyButton.style.visibility = selectedUsers.length === 0 ? 'hidden' : 'visible';
        }

        // Copy to clipboard functionality
        document.getElementById('copyButton').addEventListener('click', function() {
            const jsonString = JSON.stringify(selectedUsers, null, 2);
            copyToClipboard(jsonString);
            alert('Selected users copied to clipboard!');
        });

        // Copy JSON to clipboard
        function copyToClipboard(text) {
            const tempInput = document.createElement('textarea');
            tempInput.value = text;
            document.body.appendChild(tempInput);
            tempInput.select();
            document.execCommand('copy');
            document.body.removeChild(tempInput);
        }

        // Apply filters when checkboxes are clicked
        document.querySelectorAll('.filters input[type="checkbox"]').forEach(filter => {
            filter.addEventListener('change', applyFilters);
        });
    </script>

</body>
</html>
